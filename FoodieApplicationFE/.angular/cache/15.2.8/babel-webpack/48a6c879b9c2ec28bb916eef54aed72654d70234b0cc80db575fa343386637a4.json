{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Order } from '../model/order';\nlet ViewItemsComponent = class ViewItemsComponent {\n  constructor(restaurant, route, login, foodie, userService, _sanckBar) {\n    this.restaurant = restaurant;\n    this.route = route;\n    this.login = login;\n    this.foodie = foodie;\n    this.userService = userService;\n    this._sanckBar = _sanckBar;\n    this.restaurantItems = [];\n    this.cartItems = [];\n    this.favItems = [];\n  }\n  ngOnInit() {\n    this.data = 51;\n    this.restaurantId = this.restaurant.id;\n    if (this.login.isLoggedIn) {\n      const cartItems = this.initializeCartItems();\n      const favItems = this.initializeFavItems();\n      Promise.all([cartItems, favItems]).then(() => {\n        this.restaurant.getAllItems(+this.restaurantId).subscribe(data => {\n          this.restaurantItems = data.map(item => {\n            const cartItem = this.cartItems.find(cartitem => cartitem.itemName === item.itemName);\n            const inCart = cartItem ? true : false;\n            const favItem = this.favItems.find(favitem => favitem.itemName === item.itemName);\n            const inFav = favItem ? true : false;\n            console.log(this.restaurantItems);\n            return {\n              item,\n              inCart,\n              inFav\n            };\n          });\n        });\n      }).catch(error => {\n        console.error(\"Error retrieving favItems or cartItems:\", error);\n      });\n    } else {\n      this.restaurant.getAllItems(+this.restaurantId).subscribe(data => {\n        this.restaurantItems = data.map(item => {\n          const incart = false;\n          const inFav = false;\n          return {\n            item,\n            incart,\n            inFav\n          };\n        });\n      });\n    }\n  }\n  addToFavourites(itemData) {\n    if (this.login.isLoggedIn) {\n      if (itemData.inFav) {\n        this.userService.removeFavourite(itemData.item.itemId).subscribe({\n          next: data => {\n            this.ngOnInit();\n            this._sanckBar.open(`${itemData.item.itemName} is removed from Favourites`, 'success', {\n              duration: 3000,\n              panelClass: ['mat-toolbar', 'mat-primary']\n            });\n          },\n          error(err) {\n            alert(\"Not removed from favourites!\");\n          }\n        });\n      } else {\n        this.userService.addItemToFavourites(itemData.item).subscribe({\n          next: data => {\n            this.ngOnInit();\n            this._sanckBar.open(`${itemData.item.itemName} is added on your Favourites`, 'success', {\n              duration: 3000,\n              panelClass: ['mat-toolbar', 'mat-primary']\n            });\n          },\n          error(err) {\n            alert(\"Not added to favourites!\");\n          }\n        });\n      }\n    } else {\n      this.route.navigateByUrl(\"/login\");\n    }\n  }\n  addToCart(theItem) {\n    if (this.login.isLoggedIn) {\n      this.addtocart = new Order();\n      this.addtocart.customerId = localStorage.getItem('email') ?? '';\n      this.addtocart.billingAddress = localStorage.getItem(\"address\") ?? '';\n      if (theItem) {\n        console.log(theItem);\n        theItem.status = \"incart\";\n        theItem.count = 1;\n        if (!this.addtocart.items) {\n          this.addtocart.items = [];\n        }\n        this.addtocart.items = this.addtocart.items.concat(theItem);\n        this.foodie.insertOrder(this.addtocart).subscribe(data => {\n          this._sanckBar.open(`Item Added to Cart`, 'success', {\n            duration: 3000,\n            panelClass: ['mat-toolbar', 'mat-primary']\n          });\n        });\n      } else this.route.navigateByUrl(\"/login\");\n    } else {\n      this.route.navigateByUrl(\"/login\");\n    }\n  }\n  initializeCartItems() {\n    return new Promise((resolve, reject) => {\n      this.foodie.getItems(\"incart\", localStorage.getItem('email')).subscribe(response => {\n        console.log(\"got the items\");\n        this.cartItems = response;\n        resolve();\n      }, error => {\n        this.cartItems = [];\n        resolve();\n      });\n    });\n  }\n  initializeFavItems() {\n    return new Promise((resolve, reject) => {\n      this.userService.getListOfFavourites().subscribe(data => {\n        console.log(\"got the items\");\n        this.favItems = data;\n        resolve();\n      }, error => {\n        this.favItems = [];\n        resolve();\n      });\n    });\n  }\n  remove(item) {\n    if (item != null) {\n      if (item != undefined) {\n        this.foodie.removeItem(localStorage.getItem('email'), item).subscribe(response => {\n          this.ngOnInit();\n          alert(\"c\");\n          // this.totalPrice();\n        });\n      }\n    }\n  }\n\n  add(item) {\n    if (item != null) {\n      if (item != undefined) {\n        this.foodie.addItem(localStorage.getItem('email'), item).subscribe(responce => {\n          this.ngOnInit();\n          // this.totalPrice();\n        });\n      }\n    }\n  }\n};\n\nViewItemsComponent = __decorate([Component({\n  selector: 'app-view-items',\n  templateUrl: './view-items.component.html',\n  styleUrls: ['./view-items.component.css']\n})], ViewItemsComponent);\nexport { ViewItemsComponent };","map":{"version":3,"mappings":"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","names":["Component","Order","ViewItemsComponent","constructor","restaurant","route","login","foodie","userService","_sanckBar","ngOnInit","data","restaurantId","id","isLoggedIn","cartItems","initializeCartItems","favItems","initializeFavItems","Promise","all","then","getAllItems","subscribe","restaurantItems","map","item","cartItem","find","cartitem","itemName","inCart","favItem","favitem","inFav","console","log","catch","error","incart","addToFavourites","itemData","removeFavourite","itemId","next","open","duration","panelClass","err","alert","addItemToFavourites","navigateByUrl","addToCart","theItem","addtocart","customerId","localStorage","getItem","billingAddress","status","count","items","concat","insertOrder","resolve","reject","getItems","response","getListOfFavourites","remove","undefined","removeItem","add","addItem","responce","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["F:\\CAPSTONE PROJECT- FOODIE APP\\FoodieApplicationFE\\FoodieApplication\\src\\app\\view-items\\view-items.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { RestaurantServiceService } from '../service/restaurant-service.service';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { LoginService } from '../service/login.service';\nimport { Order } from '../model/order';\nimport { Item } from '../model/item';\nimport { FoodieService } from '../service/foodie.service';\nimport { UserService } from '../service/user.service';\nimport { MatSnackBar } from '@angular/material/snack-bar';\n\n@Component({\n  selector: 'app-view-items',\n  templateUrl: './view-items.component.html',\n  styleUrls: ['./view-items.component.css']\n})\nexport class ViewItemsComponent implements OnInit{\n  constructor(private restaurant:RestaurantServiceService,private route:Router,private login:LoginService,private foodie:FoodieService,private userService:UserService,private _sanckBar:MatSnackBar){}\n  addtocart!:Order;\n  // fav:boolean=false;\n  itemId!:boolean;\n  data:number | undefined;\n  restaurantItems:any=[];\n  cartItems:any=[];\n  favItems:any=[];\n  restaurantId!: number;\n  ngOnInit(): void {\n    this.data = 51;\n    this.restaurantId = this.restaurant.id;\n\n    if(this.login.isLoggedIn){\n      const cartItems=this.initializeCartItems();\n      const favItems=this.initializeFavItems();\n      Promise.all([cartItems,favItems]).then(()=>{\n        this.restaurant.getAllItems(+this.restaurantId).subscribe((data:any)=>{      \n          this.restaurantItems = data.map((item:any)=>{\n            const cartItem=this.cartItems.find((cartitem:any)=>cartitem.itemName===item.itemName);\n            const inCart=cartItem?true:false;\n            const favItem=this.favItems.find((favitem:any)=>favitem.itemName===item.itemName);\n            const inFav=favItem?true:false;\n            console.log(this.restaurantItems);\n            return {item,inCart,inFav};\n          });\n        });\n      }).catch((error)=>{\n        console.error(\"Error retrieving favItems or cartItems:\", error);\n      });\n    }else{\n      this.restaurant.getAllItems(+this.restaurantId).subscribe((data:any)=>{      \n        this.restaurantItems =data.map((item:any)=>{\n        const incart=false;\n        const inFav=false;\n        return {item,incart,inFav};\n        });\n      })\n    }\n  }\n\naddToFavourites(itemData:any){  \n    if(this.login.isLoggedIn){\n      if(itemData.inFav){\n          this.userService.removeFavourite(itemData.item.itemId).subscribe({\n            next:data=>{\n              this.ngOnInit();\n              this._sanckBar.open(`${itemData.item.itemName} is removed from Favourites`, 'success', {\n                duration: 3000,\n                panelClass: ['mat-toolbar', 'mat-primary']\n              });\n            },error(err) {\n                  alert(\"Not removed from favourites!\");\n            },\n          })\n      }else{\n          this.userService.addItemToFavourites(itemData.item).subscribe({\n            next:data=>{\n              this.ngOnInit();\n              this._sanckBar.open(`${itemData.item.itemName} is added on your Favourites`, 'success', {\n                duration: 3000,\n                panelClass: ['mat-toolbar', 'mat-primary']\n              });\n            },error(err) {\n                  alert(\"Not added to favourites!\");\n            },\n          })}\n}else{\n  this.route.navigateByUrl(\"/login\");\n}\n}\n          \naddToCart(theItem:any){\n  if(this.login.isLoggedIn){\n    this.addtocart = new Order();\n    this.addtocart.customerId = localStorage.getItem('email') ?? '';\n    this.addtocart.billingAddress=localStorage.getItem(\"address\")?? '';\n    if (theItem) {\n      console.log(theItem);\n      theItem.status=\"incart\";\n      theItem.count=1;\n      if (!this.addtocart.items) {\n        this.addtocart.items = [];\n      }\n      this.addtocart.items = this.addtocart.items.concat(theItem);\n      this.foodie.insertOrder(this.addtocart).subscribe(data=>{\n        this._sanckBar.open(`Item Added to Cart`, 'success', {\n          duration: 3000,\n          panelClass: ['mat-toolbar', 'mat-primary']\n        });\n      });\n      }else\n  this.route.navigateByUrl(\"/login\");\n}  else{this.route.navigateByUrl(\"/login\");}\n}\n\nprivate initializeCartItems():Promise<void>{\n  return new Promise((resolve,reject)=>{\n    this.foodie.getItems(\"incart\",localStorage.getItem('email')).subscribe(response=>{\n      console.log(\"got the items\");\n      this.cartItems=response; \n      resolve();\n    },(error)=>{\n      this.cartItems=[];\n      resolve();\n    });\n  })\n \n    \n}\nprivate initializeFavItems():Promise<void>{\n  return new Promise((resolve,reject)=>{\n    this.userService.getListOfFavourites().subscribe((data:any)=>{\n      console.log(\"got the items\");\n      this.favItems = data;\n      resolve();\n    },(error)=>{\n      this.favItems=[];\n      resolve();\n    })\n  })\n }\n\n\n\n\n\n remove(item?:Item){\n  if(item!=null){\n    if(item!=undefined){\n    this.foodie.removeItem(localStorage.getItem('email'),item).subscribe(response=>{\n      this.ngOnInit();\n      alert(\"c\")\n      // this.totalPrice();\n          });\n    }\n  }\n} \n \nadd(item?:Item){\n  if(item!=null){\n    if(item!=undefined){\n    this.foodie.addItem(localStorage.getItem('email'),item).subscribe(responce=>{\n      this.ngOnInit();\n      // this.totalPrice();\n    })\n    }\n  }\n}\n\n}"]},"metadata":{},"sourceType":"module","externalDependencies":[]}