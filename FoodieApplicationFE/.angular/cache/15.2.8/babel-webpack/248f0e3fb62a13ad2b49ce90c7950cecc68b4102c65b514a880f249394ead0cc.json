{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Validators } from '@angular/forms';\nlet LoginComponent = class LoginComponent {\n  constructor(fb, userService, _sanckBar, route, loginStatus) {\n    this.fb = fb;\n    this.userService = userService;\n    this._sanckBar = _sanckBar;\n    this.route = route;\n    this.loginStatus = loginStatus;\n    this.loginForm = this.fb.group({\n      email: [\"\", [Validators.required, this.checkIfGuestEmailsAreValid]],\n      password: [\"\", [Validators.required, Validators.minLength(7)]]\n    });\n  }\n  ngOnInit() {\n    this.loginStatus.search.emit(true);\n  }\n  ngOnDestroy() {\n    this.loginStatus.search.emit(false);\n  }\n  get email() {\n    return this.loginForm.get('email');\n  }\n  get password() {\n    return this.loginForm.get('password');\n  }\n  checkIfGuestEmailsAreValid(c) {\n    if (c.value !== '') {\n      const emailString = c.value;\n      const emails = emailString.split(',').map(e => e.trim());\n      const emailRegex = /^(([^<>()[\\]\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(gmail\\.com|yahoo\\.com)$/i;\n      const anyInvalidEmail = emails.every(e => e.match(emailRegex) !== null);\n      if (!anyInvalidEmail) {\n        return {\n          checkIfGuestEmailsAreValid: false\n        };\n      }\n    }\n    return null;\n  }\n  loginCheck() {\n    this.userService.login(this.loginForm.value).subscribe({\n      next: data => {\n        this.responseData = data;\n        localStorage.setItem('jwt', this.responseData.Token);\n        localStorage.setItem('email', this.responseData.email);\n        localStorage.setItem(\"role\", this.responseData.role);\n        console.log(localStorage.getItem(\"jwt\"));\n        this._sanckBar.open('Logged In successfully.....', 'success', {\n          duration: 3000,\n          panelClass: ['mat-toolbar', 'mat-primary']\n        });\n        if (this.responseData.role === \"adminRole\") {\n          this.route.navigateByUrl('/admin');\n          this.loginStatus.loginSuccess();\n          this.loginStatus.adminLoginSuccess();\n          this.loginStatus.getLoginStatus();\n          this.loginStatus.admin();\n        } else {\n          this.loginStatus.loginSuccess();\n          this.loginStatus.getLoginStatus();\n          this.route.navigateByUrl(\"\");\n        }\n      },\n      error: err => {\n        this.loginStatus.onFailure();\n        alert(\"Authorization failed, Please check the provided details again!\");\n      }\n    });\n  }\n};\nLoginComponent = __decorate([Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css']\n})], LoginComponent);\nexport { LoginComponent };","map":{"version":3,"mappings":";AAAA,SAASA,SAAS,QAA2B,eAAe;AAC5D,SAAkDC,UAAU,QAAQ,gBAAgB;AAW7E,IAAMC,cAAc,GAApB,MAAMA,cAAc;EAIzBC,YAAoBC,EAAc,EAASC,WAAuB,EAASC,SAAqB,EAASC,KAAY,EAASC,WAAwB;IAAlI,OAAE,GAAFJ,EAAE;IAAqB,gBAAW,GAAXC,WAAW;IAAqB,cAAS,GAATC,SAAS;IAAqB,UAAK,GAALC,KAAK;IAAgB,gBAAW,GAAXC,WAAW;IAOzI,cAAS,GAAG,IAAI,CAACJ,EAAE,CAACK,KAAK,CAAC;MACxBC,KAAK,EAAC,CAAC,EAAE,EAAC,CAACT,UAAU,CAACU,QAAQ,EAAC,IAAI,CAACC,0BAA0B,CAAC,CAAC;MAChEC,QAAQ,EAAC,CAAC,EAAE,EAAC,CAACZ,UAAU,CAACU,QAAQ,EAACV,UAAU,CAACa,SAAS,CAAC,CAAC,CAAC,CAAC;KAC3D,CAAC;EAVsJ;EACxJC,QAAQ;IACN,IAAI,CAACP,WAAW,CAACQ,MAAM,CAACC,IAAI,CAAC,IAAI,CAAC;EACpC;EACAC,WAAW;IACT,IAAI,CAACV,WAAW,CAACQ,MAAM,CAACC,IAAI,CAAC,KAAK,CAAC;EACrC;EAMA,IAAIP,KAAK;IACP,OAAO,IAAI,CAACS,SAAS,CAACC,GAAG,CAAC,OAAO,CAAC;EACpC;EAEA,IAAIP,QAAQ;IACV,OAAO,IAAI,CAACM,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;EACvC;EAEAR,0BAA0B,CAACS,CAAkB;IAE3C,IAAIA,CAAC,CAACC,KAAK,KAAK,EAAE,EAAE;MAClB,MAAMC,WAAW,GAAGF,CAAC,CAACC,KAAK;MAC3B,MAAME,MAAM,GAAGD,WAAW,CAACE,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAAEC,CAAS,IAAKA,CAAC,CAACC,IAAI,EAAE,CAAC;MAClE,MAAMC,UAAU,GAAG,yFAAyF;MAC5G,MAAMC,eAAe,GAAGN,MAAM,CAACO,KAAK,CAAEJ,CAAS,IAAKA,CAAC,CAACK,KAAK,CAACH,UAAU,CAAC,KAAK,IAAI,CAAC;MACjF,IAAI,CAACC,eAAe,EAAE;QACpB,OAAO;UAAElB,0BAA0B,EAAE;QAAK,CAAE;;;IAGhD,OAAO,IAAI;EACb;EAEAqB,UAAU;IACN,IAAI,CAAC5B,WAAW,CAAC6B,KAAK,CAAC,IAAI,CAACf,SAAS,CAACG,KAAK,CAAC,CAACa,SAAS,CAAC;MACrDC,IAAI,EAACC,IAAI,IAAE;QACT,IAAI,CAACC,YAAY,GAACD,IAAI;QACtBE,YAAY,CAACC,OAAO,CAAC,KAAK,EAAC,IAAI,CAACF,YAAY,CAACG,KAAK,CAAC;QACnDF,YAAY,CAACC,OAAO,CAAC,OAAO,EAAC,IAAI,CAACF,YAAY,CAAC5B,KAAK,CAAC;QACrD6B,YAAY,CAACC,OAAO,CAAC,MAAM,EAAC,IAAI,CAACF,YAAY,CAACI,IAAI,CAAC;QACnDC,OAAO,CAACC,GAAG,CAACL,YAAY,CAACM,OAAO,CAAC,KAAK,CAAC,CAAC;QACxC,IAAI,CAACvC,SAAS,CAACwC,IAAI,CAAC,6BAA6B,EAAE,SAAS,EAAE;UAC5DC,QAAQ,EAAE,IAAI;UACdC,UAAU,EAAE,CAAC,aAAa,EAAE,aAAa;SAC1C,CAAC;QACF,IAAG,IAAI,CAACV,YAAY,CAACI,IAAI,KAAG,WAAW,EAAC;UACtC,IAAI,CAACnC,KAAK,CAAC0C,aAAa,CAAC,QAAQ,CAAC;UAClC,IAAI,CAACzC,WAAW,CAAC0C,YAAY,EAAE;UAC/B,IAAI,CAAC1C,WAAW,CAAC2C,iBAAiB,EAAE;UACpC,IAAI,CAAC3C,WAAW,CAAC4C,cAAc,EAAE;UACjC,IAAI,CAAC5C,WAAW,CAAC6C,KAAK,EAAE;SACzB,MAAI;UACL,IAAI,CAAC7C,WAAW,CAAC0C,YAAY,EAAE;UAC/B,IAAI,CAAC1C,WAAW,CAAC4C,cAAc,EAAE;UACjC,IAAI,CAAC7C,KAAK,CAAC0C,aAAa,CAAC,EAAE,CAAC;;MAE9B,CAAC;MAACK,KAAK,EAAEC,GAAG,IAAG;QACZ,IAAI,CAAC/C,WAAW,CAACgD,SAAS,EAAE;QAC7BC,KAAK,CAAC,gEAAgE,CAAC;MACzE;KACD,CAAC;EACN;CACD;AAnEYvD,cAAc,eAL1BF,SAAS,CAAC;EACT0D,QAAQ,EAAE,WAAW;EACrBC,WAAW,EAAE,wBAAwB;EACrCC,SAAS,EAAE,CAAC,uBAAuB;CACpC,CAAC,GACW1D,cAAc,CAmE1B;SAnEYA,cAAc","names":["Component","Validators","LoginComponent","constructor","fb","userService","_sanckBar","route","loginStatus","group","email","required","checkIfGuestEmailsAreValid","password","minLength","ngOnInit","search","emit","ngOnDestroy","loginForm","get","c","value","emailString","emails","split","map","e","trim","emailRegex","anyInvalidEmail","every","match","loginCheck","login","subscribe","next","data","responseData","localStorage","setItem","Token","role","console","log","getItem","open","duration","panelClass","navigateByUrl","loginSuccess","adminLoginSuccess","getLoginStatus","admin","error","err","onFailure","alert","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["F:\\CAPSTONE PROJECT- FOODIE APP\\FoodieApplicationFE\\FoodieApplication\\src\\app\\login\\login.component.ts"],"sourcesContent":["import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { AbstractControl, FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { UserService } from '../service/user.service';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { Router } from '@angular/router';\nimport { LoginService } from '../service/login.service';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css']\n})\nexport class LoginComponent implements OnInit,OnDestroy{\n\n  responseData:any;\n\n  constructor(private fb:FormBuilder,private userService:UserService,private _sanckBar:MatSnackBar,private route:Router,private loginStatus:LoginService){}\n  ngOnInit(): void {\n    this.loginStatus.search.emit(true);\n  }\n  ngOnDestroy(): void {\n    this.loginStatus.search.emit(false);\n  }\n  loginForm = this.fb.group({\n    email:[\"\",[Validators.required,this.checkIfGuestEmailsAreValid]],\n    password:[\"\",[Validators.required,Validators.minLength(7)]]\n  })\n\n  get email(){\n    return this.loginForm.get('email');\n  }\n\n  get password(){\n    return this.loginForm.get('password')\n  }\n\n  checkIfGuestEmailsAreValid(c: AbstractControl) {\n \n    if (c.value !== '') {\n      const emailString = c.value;\n      const emails = emailString.split(',').map((e: string) => e.trim());\n      const emailRegex = /^(([^<>()[\\]\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(gmail\\.com|yahoo\\.com)$/i;\n      const anyInvalidEmail = emails.every((e: string) => e.match(emailRegex) !== null);\n      if (!anyInvalidEmail) {\n        return { checkIfGuestEmailsAreValid: false }\n      }\n    }\n    return null;\n  }\n\n  loginCheck(){    \n      this.userService.login(this.loginForm.value).subscribe({\n        next:data=>{\n          this.responseData=data; \n          localStorage.setItem('jwt',this.responseData.Token);\n          localStorage.setItem('email',this.responseData.email);\n          localStorage.setItem(\"role\",this.responseData.role);\n          console.log(localStorage.getItem(\"jwt\"));\n          this._sanckBar.open('Logged In successfully.....', 'success', {\n            duration: 3000,\n            panelClass: ['mat-toolbar', 'mat-primary']\n          });\n          if(this.responseData.role===\"adminRole\"){\n            this.route.navigateByUrl('/admin');\n            this.loginStatus.loginSuccess();\n            this.loginStatus.adminLoginSuccess();\n            this.loginStatus.getLoginStatus();\n            this.loginStatus.admin();\n          }else{\n          this.loginStatus.loginSuccess();\n          this.loginStatus.getLoginStatus();\n          this.route.navigateByUrl(\"\");\n          }\n        },error:(err)=>{\n           this.loginStatus.onFailure()\n          alert(\"Authorization failed, Please check the provided details again!\")\n        }\n      })\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}